# jsdl3

## What is this?

An experiment for learning about the [Java 22+ Foreign Function and Memory API (FFM)](https://docs.oracle.com/en/java/javase/22/core/foreign-function-and-memory-api.html)
by exposing [SDL3 `v3.2.0+`](https://github.com/libsdl-org/SDL/tree/release-3.2.0) as a Java library.

## How does it work?

I'll let you know once there's an 'it' that works.

## Project Notes

### Setup

1) Created this repo as a multi-module gradle project by running `gradle init` in an empty root folder
    - added a root `build.gradle.kts` file since it wasn't included by default
    - modified `settings.gradle.kts` for the following gradle module name changes:
       - renamed the generated `app` module to `jsdl3-app`, as it will contain a test application
       - renamed the generated `list` module to `sdl-native` to contain SDL code and build config
       - renamed the generated `utilities` module to `sdl-bindings` to contain SDL java bindings generated by `jextract`
    - replaced the `jsdl3-app` module default package and source with `net.bplo.jsdl3.App`
    - removed generated packages and source from `sdl-native` and `sdl-bindings` modules
2) Add [SDL](https://github.com/libsdl-org/SDL) as a git submodule under the `sdl-native` gradle module
    - add and initialize the new git submodule:
        - `git submodule add https://github.com/libsdl-org/SDL.git ./sdl-native/src/main/cpp`
    - pin submodule to target commit for tag [`release-3.2.0`](https://github.com/libsdl-org/SDL/tree/release-3.2.0)
        - `pushd ./sdl-native/src/main/cpp && git checkout release-3.2.0 && popd`
        - `git submodule update`
3) Spend lots of time making :kissing: faces at gradle to create build tasks related to `jextract` in `sdl-bindings`
    - there's a lot to say about this piece, because figuring out how to use gradle is maddening
      and I learned a bunch from this process but didn't write it out as I went so that I didn't lose my mind
    - :pushpin: rework the `unpack` task to use the built-in `Tar` task type in gradle instead of `Exec`
4) Spend less time making :kissing: faces at gradle to create build tasks related to `cmake` in `sdl-native`
    - there's a lot to say here too, especially since there's the possibility of leveraging gradle's
      `cpp-application` and/or `cpp-library` plugins rather than invoking `cmake` directly in `Exec` tasks
